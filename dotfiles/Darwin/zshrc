HISTFILE="$HOME/.zsh_history"
HISTSIZE=10000 # History in memory
SAVEHIST=10000 # Lines in the HISTFILE
PS1="%F{red}Â»%f "

#setopt extended_history # Adds timestamps and exit statuses to each entry saved in HISTFILE
#setopt share_history # Share history between sessions
setopt hist_ignore_dups # Ignore duplicate commands
setopt hist_reduce_blanks # Trim excess blanks
setopt hist_verify # Ask for confirmation before executing a history-expanded command
setopt inc_append_history # Write to the history file after each command

# Shell completions user dir
[[ -d "$HOME/.zsh/zfunc" ]] || mkdir -p "$HOME/.zsh/zfunc"
fpath+=("$HOME/.zsh/zfunc")

# Enable completion system
autoload -Uz compinit && compinit
autoload -Uz +X bashcompinit && bashcompinit # Zsh function that sets up Bash-style completion

# Use caching to speed up completion startup
[[ -d "$HOME/.zsh/cache" ]] || mkdir -p "$HOME/.zsh/cache"

zstyle ':completion::complete:*' use-cache on
zstyle ':completion::complete:*' cache-path "$HOME/.zsh/cache"

# Show completion menu when multiple options exist
zstyle ':completion:*' menu select
zstyle ':completion:*' list-colors ''

# Fast completion (no description)
zstyle ':completion:*' verbose no
zstyle ':completion:*' format '%d'
zstyle ':completion:*' group-name ''

# Skip unnecessary prompt recalculations
zstyle ':completion:*' rehash true

setopt auto_menu # Show completion menu on successive tab

# Setting up fzf shell integration
if command -v fzf >/dev/null 2>&1; then
    export FZF_DEFAULT_OPTS='--height=40% --layout=reverse --info=inline-right --color=16 --pointer=""'
    . <(fzf --zsh)
fi

# Setting up terraform shell completion
if command -v terraform >/dev/null 2>&1; then
    complete -o nospace -C $(which terraform) terraform
fi

# Avoid duplicates in PATH
typeset -U path
export PATH
